<!-- post-auth.html (inside <body>) -->
<script src="/config.js?v=3"></script>
<script src="/components.js?v=3"></script>

<header id="site-header"></header>

<main class="container">
  <h1>You're signed in</h1>
  <p>
    Go to <a class="link" href="/employer.html">Employer</a> or
    <a class="link" href="/jobs.html">browse jobs</a>.
    <a id="adminLink" class="btn hidden" href="/admin.html" style="margin-left:12px;">Admin</a>
  </p>
  <p class="muted">If you see this page after clicking the email link, your session was created successfully.</p>
</main>

<script>
(async () => {
  // Render header (it will show Login/Logout)
  if (typeof header === 'function') header();

  // Reveal Admin button if you're an admin
  const { data: { session } } = await sbAuth.getSession();
  if (session?.user?.id) {
    // simpler than RPC: check admins table
    const { data } = await supabase
      .from('admins')
      .select('user_id')
      .eq('user_id', session.user.id)
      .maybeSingle();
    if (data) document.getElementById('adminLink').classList.remove('hidden');
  }
})();
</script>
