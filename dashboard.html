<!doctype html>
<html lang="en">
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Candidate Dashboard</title>
<style>
  :root{--blue:#151B54;--blue-600:#0F143E;--bg:#F6F8FC;--line:#E5E7EB}
  body{margin:0;background:var(--bg);font-family:Inter,"Noto Sans",system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial,sans-serif}
  header{background:#fff;border-bottom:1px solid var(--line)}
  .nav{max-width:1200px;margin:0 auto;padding:0 16px;display:flex;align-items:center;justify-content:space-between;height:72px}
  .brand{font-weight:800}
  .wrap{max-width:960px;margin:24px auto;padding:0 16px}
  .card{background:#fff;border:1px solid var(--line);border-radius:16px;box-shadow:0 6px 18px rgba(2,6,23,.06);padding:20px}
  .btn{display:inline-block;background:#151B54;color:#fff;padding:10px 14px;border-radius:12px;text-decoration:none;font-weight:800}
  .muted{color:#64748B}
</style>
<header>
  <div class="nav">
    <div class="brand">GrowIndia Jobs</div>
    <div></div>
  </div>
</header>
<div class="wrap">
  <div class="card">
    <h2 style="margin:0 0 6px">Welcome<span id="name"></span>!</h2>
    <div id="msg" class="muted" style="margin-bottom:12px"></div>
    <a class="btn" href="/register-candidate-step2.html">Complete your profile â†’</a>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.min.js"></script>
<script src="/config.js"></script>
<script src="/components.js?v=19"></script>
<script>
(async function(){
  await app.requireAuth({ redirectTo: '/register-candidate.html' });
  const user = await app.getSessionUser();
  const { data: profile } = await app.getProfile(user.id);
  if(profile?.full_name){ document.getElementById('name').textContent = `, ${profile.full_name}`; }
  const p = new URLSearchParams(location.search);
  if(p.has('welcome')) document.getElementById('msg').textContent = 'Your email is verified and you are signed in.';
  else if(p.has('from')) document.getElementById('msg').textContent = 'Account created. You can complete your profile anytime.';
  else if(p.has('updated')) document.getElementById('msg').textContent = 'Profile updated successfully.';
  else if(p.has('skip')) document.getElementById('msg').textContent = 'You can complete the rest of your profile later.';
})();
</script>
